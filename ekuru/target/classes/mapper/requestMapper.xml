<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.scit.ekuru.dao.RequestMapper">
<!-- 메인에 전체 게시글 불러오기 -->
<select id="selectRequestAll" resultType="request">
select
	reqNum
	,userId
	,categoryCode
	,reqTitle
	,reqContent
from
	e_request_tb
</select>
<!-- 요청글 쓰기 insert -->
<insert id="insertOne" parameterType="request">
insert into 
	e_request_tb(
	    reqNum
	    ,userId
	    ,categoryCode
	    ,reqTitle
	    ,reqContent
	)values(
	    reqnum_seq.nextval
	    ,#{userId}
	    ,#{categoryCode}
	    ,#{reqTitle}
	    ,#{reqContent}
	)
</insert>
<!-- 게시글 작성한 것 불러오기 select -->
<select id="selectReqOne" parameterType="int" resultType="request">
select
	reqNum
    ,userId
    ,categoryCode
    ,reqTitle
    ,reqContent
    ,reqIndate
from
	e_request_tb
where
	reqNum = #{reqNum}
</select>
<update id="updateRequest" parameterType="request">
update
	e_request_tb
set
	categoryCode = #{categoryCode}
	,reqTitle = #{reqTitle}
	,reqContent = #{reqContent}
where
	reqNum = #{reqNum}
	and userId = #{userId}
</update>
<!-- 카테고리별 목록 출력 -->
<select id="requestCategoryResult" parameterType="int" resultType="request">
select
	reqNum
	,userId
	,categoryCode
	,reqTitle
	,reqContent
	,reqIndate
from
	e_request_tb
where
	categoryCode = #{categoryCode}
</select>
<!-- 코멘트 달기 -->
<insert id="insertComment" parameterType="comment">
insert into
	e_requestComment_tb(
		reqCommentNum
		,userId
		,reqNum
		,reqComment
	)values(
		reqCommentNum_seq.nextval
		,#{userId}
		,#{reqNum}
		,#{reqComment}
	)
</insert>
<!-- 코멘트 불러오기 -->
<select id="selectComment" resultType="comment">
select
	reqCommentNum
	,userId
	,reqNum
	,reqComment
from
	e_requestComment_tb
where
	reqNum = #{reqNum}
</select>
<delete id="deleteComment" parameterType="comment">
delete
from
	e_requestComment_tb
where
	reqCommentNum = #{reqCommentNum}
	and
	userId = #{userId}
</delete>

</mapper>
